# 零食商城项目学习指南

## 📋 项目概述

这是一个基于 **Spring Boot + Vue 3** 的完整电商系统，实现了零食销售的全流程管理，包括用户管理、商品管理、订单处理、支付集成、物流跟踪、智能客服等核心功能。

### 🎯 项目特色
- **前后端分离架构**：后端提供RESTful API，前端独立部署
- **多角色权限系统**：用户、商家、管理员三种角色
- **完整电商流程**：从商品浏览到订单完成的完整闭环
- **智能客服系统**：集成Ollama AI，支持数据库查询和业务咨询
- **支付集成**：支付宝沙箱环境，支持真实支付流程
- **现代化UI**：基于Element Plus的响应式设计

---

## 🏗️ 技术架构

### 后端技术栈
- **框架**：Spring Boot 2.6.13
- **语言**：Java 8
- **数据库**：MySQL 8.0
- **ORM**：Spring Data JPA + MyBatis
- **安全**：Spring Security + JWT
- **支付**：支付宝SDK 4.35.79
- **AI集成**：Ollama (qwen2.5:7b模型)
- **构建工具**：Maven 3.8.1

### 前端技术栈
- **框架**：Vue 3.5.18
- **语言**：TypeScript 5.8.0
- **UI库**：Element Plus 2.11.1
- **状态管理**：Pinia 3.0.3
- **路由**：Vue Router 4.5.1
- **HTTP客户端**：Axios 1.11.0
- **图表**：ECharts 6.0.0
- **构建工具**：Vite 7.0.6

### 开发环境配置
- **数据库**：MySQL 8.0 (localhost:3306)
- **后端端口**：8080
- **前端端口**：3000 (开发环境)
- **AI服务**：Ollama (localhost:11434)
- **内网穿透**：ngrok (用于支付宝回调)

---

## 📁 项目结构详解

### 后端结构 (src/main/java/com/example/shop/)
```
├── config/          # 配置类
│   ├── SecurityConfig.java      # Spring Security配置
│   └── WebConfig.java          # Web配置
├── controller/      # 控制器层
│   ├── AuthController.java     # 认证控制器
│   ├── UserController.java     # 用户管理
│   ├── ProductController.java  # 商品管理
│   ├── OrderController.java    # 订单管理
│   ├── AlipayController.java   # 支付宝支付
│   ├── ChatController.java     # 智能客服
│   └── ...
├── entity/          # 实体类
│   ├── User.java              # 用户实体
│   ├── Product.java           # 商品实体
│   ├── Order.java             # 订单实体
│   ├── CartItem.java          # 购物车项
│   ├── Review.java            # 评价实体
│   ├── Favorite.java          # 收藏实体
│   └── ...
├── repository/      # 数据访问层
│   ├── UserRepository.java    # 用户数据访问
│   ├── ProductRepository.java # 商品数据访问
│   ├── OrderRepository.java   # 订单数据访问
│   └── ...
├── service/         # 服务层
│   ├── UserService.java       # 用户业务逻辑
│   ├── ProductService.java    # 商品业务逻辑
│   ├── OrderService.java      # 订单业务逻辑
│   ├── ChatService.java       # 智能客服业务
│   └── ...
├── vo/              # 视图对象
│   ├── UserVO.java           # 用户视图对象
│   ├── ProductVO.java        # 商品视图对象
│   ├── OrderVO.java          # 订单视图对象
│   └── ...
├── dto/             # 数据传输对象
├── exception/       # 异常处理
├── util/            # 工具类
└── ShopApplication.java      # 启动类
```

### 前端结构 (frontend/src/)
```
├── api/             # API接口
│   ├── auth.ts              # 认证相关API
│   ├── user.ts              # 用户相关API
│   ├── product.ts           # 商品相关API
│   ├── order.ts             # 订单相关API
│   ├── cart.ts              # 购物车相关API
│   ├── chat.ts              # 智能客服API
│   └── ...
├── components/      # 公共组件
│   ├── ChatWidget.vue       # 智能客服组件
│   ├── CartNavItem.vue      # 购物车导航项
│   └── ...
├── views/           # 页面组件
│   ├── Home.vue             # 首页
│   ├── Products.vue         # 商品列表
│   ├── ProductDetail.vue    # 商品详情
│   ├── Cart.vue             # 购物车
│   ├── Orders.vue           # 订单列表
│   ├── Login.vue            # 登录页
│   ├── Register.vue         # 注册页
│   ├── user/                # 用户相关页面
│   │   ├── UserCenter.vue   # 用户中心
│   │   └── Favorites.vue    # 收藏页面
│   ├── merchant/            # 商家相关页面
│   │   ├── MerchantDashboard.vue  # 商家后台
│   │   ├── ProductManage.vue      # 商品管理
│   │   └── OrderManage.vue        # 订单管理
│   └── admin/               # 管理员相关页面
│       ├── AdminDashboard.vue     # 管理员后台
│       ├── UserManage.vue         # 用户管理
│       └── MerchantManage.vue     # 商家管理
├── stores/          # 状态管理
│   ├── user.ts              # 用户状态
│   └── counter.ts           # 计数器状态
├── router/          # 路由配置
│   └── index.ts             # 路由定义
├── App.vue          # 根组件
└── main.ts          # 入口文件
```

---

## 🗄️ 数据库设计

### 核心表结构

#### 1. 用户相关表
- **users** - 用户基础信息表
  - 字段：id, username, password, email, phone, avatar, role, created_at, updated_at
  - 角色：USER(普通用户), MERCHANT(商家), ADMIN(管理员)

- **merchants** - 商家信息表
  - 字段：id, user_id, name, description, status, created_at, updated_at
  - 状态：PENDING(待审核), APPROVED(已通过), REJECTED(已拒绝), SUSPENDED(已暂停)

#### 2. 商品相关表
- **categories** - 商品分类表
  - 字段：id, name, parent_id, sort_order, created_at
  - 支持多级分类结构

- **products** - 商品信息表
  - 字段：id, name, description, price, stock, category_id, merchant_id, status, images, created_at, updated_at
  - 状态：ON_SALE(在售), OFF_SALE(下架), SOLD_OUT(售罄)

- **favorites** - 商品收藏表
  - 字段：id, user_id, product_id, created_at

#### 3. 订单相关表
- **orders** - 订单主表
  - 字段：id, order_no, user_id, total_amount, status, remark, created_at, updated_at
  - 状态：UNPAID(待付款), PAID(已付款), SHIPPED(已发货), FINISHED(已完成), CLOSED(已关闭)

- **order_items** - 订单项表
  - 字段：id, order_id, product_id, quantity, price, product_snapshot, created_at

- **shipments** - 物流信息表
  - 字段：id, order_id, tracking_number, carrier, status, created_at, updated_at

- **logistics_tracks** - 物流跟踪表
  - 字段：id, shipment_id, status, description, location, created_at

#### 4. 购物车相关表
- **cart_items** - 购物车项表
  - 字段：id, user_id, product_id, quantity, checked, created_at, updated_at

#### 5. 评价相关表
- **reviews** - 商品评价表
  - 字段：id, user_id, order_item_id, rating, content, images, is_anonymous, created_at

#### 6. 地址相关表
- **addresses** - 用户地址表
  - 字段：id, user_id, name, phone, province, city, district, detail, is_default, created_at, updated_at

---

## 🔄 核心业务流程

### 1. 用户注册登录流程
```
用户注册 → 邮箱验证 → 账户激活 → 登录系统 → JWT令牌生成 → 权限验证
```

### 2. 商品浏览购买流程
```
商品分类浏览 → 商品搜索筛选 → 商品详情查看 → 加入购物车 → 购物车管理 → 结算下单 → 选择地址 → 支付处理 → 订单确认
```

### 3. 订单处理流程
```
订单创建 → 支付处理 → 商家接单 → 商品发货 → 物流跟踪 → 用户收货 → 订单完成 → 商品评价
```

### 4. 支付流程
```
选择支付方式 → 支付宝支付 → 支付回调 → 订单状态更新 → 库存扣减 → 支付成功通知
```

### 5. 商家管理流程
```
商家注册 → 资质审核 → 商品上架 → 订单处理 → 发货管理 → 物流跟踪 → 数据统计
```

---

## 🔧 关键配置说明

### 数据库配置
```yaml
spring:
  datasource:
    url: jdbc:mysql://localhost:3306/shop_db?useUnicode=true&characterEncoding=utf8&useSSL=false&serverTimezone=Asia/Shanghai&allowPublicKeyRetrieval=true
    username: root
    password: 123456
    driver-class-name: com.mysql.cj.jdbc.Driver
```

### JWT认证配置
```yaml
jwt:
  secret: shop-system-secret-key-2024
  expiration: 86400000  # 24小时
```

### 支付宝沙箱配置
```yaml
alipay:
  gateway-url: https://openapi-sandbox.dl.alipaydev.com/gateway.do
  app-id: 9021000151650950
  notify-url: https://b5dd938b2376.ngrok-free.app/api/alipay/notify
  return-url: https://b5dd938b2376.ngrok-free.app/api/alipay/redirect
```

### 智能客服配置
```yaml
chatbot:
  ollama-url: http://localhost:11434
  model: qwen2.5:7b
  max-tokens: 1024
  temperature: 0.5
```

---

## 🚀 学习路径建议

### 第一阶段：基础理解 (1-2天)
1. **项目结构分析** - 理解前后端分离架构
2. **数据库设计** - 查看表结构和关系
3. **配置文件** - 理解各种配置参数
4. **环境搭建** - 本地运行项目

### 第二阶段：核心功能学习 (3-5天)
1. **用户系统** - 注册、登录、权限控制
2. **商品系统** - 商品管理、分类、搜索
3. **购物车系统** - 添加、修改、删除商品
4. **订单系统** - 下单、支付、状态管理

### 第三阶段：高级功能学习 (2-3天)
1. **支付集成** - 支付宝SDK使用
2. **智能客服** - AI集成和数据库查询
3. **文件上传** - 图片处理和管理
4. **物流跟踪** - 第三方物流API集成

### 第四阶段：代码优化 (2-3天)
1. **代码审查** - 设计模式分析
2. **性能优化** - 数据库查询优化
3. **安全加固** - 输入验证、SQL注入防护
4. **测试编写** - 单元测试、集成测试

---

## 🛠️ 开发工具推荐

### 后端开发
- **IDE**：IntelliJ IDEA / Eclipse
- **数据库工具**：Navicat / DBeaver / MySQL Workbench
- **API测试**：Postman / Insomnia
- **版本控制**：Git

### 前端开发
- **IDE**：VS Code / WebStorm
- **浏览器工具**：Chrome DevTools
- **包管理**：npm / yarn
- **构建工具**：Vite

### 调试工具
- **后端调试**：IDE断点调试
- **前端调试**：浏览器开发者工具
- **网络调试**：Fiddler / Charles
- **数据库调试**：SQL查询分析

---

## 📚 学习资源

### 官方文档
- [Spring Boot官方文档](https://spring.io/projects/spring-boot)
- [Vue 3官方文档](https://vuejs.org/)
- [Element Plus文档](https://element-plus.org/)
- [MySQL官方文档](https://dev.mysql.com/doc/)

### 技术博客
- Spring Boot最佳实践
- Vue 3组合式API
- 电商系统设计模式
- 微服务架构设计

### 实践项目
- 功能扩展：添加新的商品属性
- 性能优化：数据库查询优化
- 安全加固：输入验证和权限控制
- 测试完善：编写单元测试和集成测试

---

## 🎯 学习目标

### 短期目标 (1-2周)
- [ ] 理解项目整体架构
- [ ] 掌握核心业务流程
- [ ] 能够独立修改和扩展功能
- [ ] 熟悉前后端交互机制

### 中期目标 (1个月)
- [ ] 能够独立开发新功能模块
- [ ] 掌握性能优化技巧
- [ ] 理解安全防护机制
- [ ] 能够进行代码重构

### 长期目标 (2-3个月)
- [ ] 能够设计完整的电商系统
- [ ] 掌握微服务架构设计
- [ ] 具备系统架构能力
- [ ] 能够指导团队开发

---

## 📝 学习笔记模板

### 功能模块学习
```
模块名称：用户管理
学习时间：2024-XX-XX
核心文件：
- User.java (实体类)
- UserService.java (业务逻辑)
- UserController.java (控制器)
- User.vue (前端页面)

关键知识点：
1. JWT认证机制
2. 密码加密存储
3. 角色权限控制
4. 前后端数据交互

遇到的问题：
1. 问题描述
2. 解决方案
3. 学习收获
```

### 代码修改记录
```
修改时间：2024-XX-XX
修改文件：ProductController.java
修改内容：添加商品搜索功能
修改原因：用户反馈搜索功能不完善
技术要点：
1. 使用JPA Specification进行动态查询
2. 支持多条件组合搜索
3. 添加分页和排序功能
```

---

## 🔍 常见问题解答

### Q1: 如何启动项目？
A: 后端使用 `mvn spring-boot:run`，前端使用 `npm run dev`

### Q2: 数据库连接失败怎么办？
A: 检查MySQL服务是否启动，确认数据库配置是否正确

### Q3: 前端页面无法访问？
A: 检查后端服务是否启动，确认端口配置是否正确

### Q4: 支付功能无法使用？
A: 检查ngrok服务是否启动，确认支付宝配置是否正确

### Q5: 智能客服无法响应？
A: 检查Ollama服务是否启动，确认模型是否正确加载

---

## 📞 技术支持

如果在学习过程中遇到问题，可以通过以下方式获取帮助：

1. **查看项目文档** - 仔细阅读README和代码注释
2. **分析错误日志** - 查看控制台输出和日志文件
3. **调试代码** - 使用断点调试功能
4. **查阅资料** - 参考官方文档和技术博客
5. **寻求帮助** - 向有经验的开发者请教

---

**祝学习愉快！** 🎉

记住：学习是一个循序渐进的过程，不要急于求成。先理解基础概念，再深入具体实现，最后进行优化和扩展。通过这个项目，你将掌握现代Web开发的核心技能。
