# 智能客服系统安装说明

## 概述
本系统使用 **Ollama + 本地大模型** 实现智能客服功能，完全免费且本地化部署。

## 安装步骤

### 1. 安装 Ollama

#### Windows 用户：
1. 访问 [Ollama官网](https://ollama.ai/download)
2. 下载 Windows 版本安装包
3. 运行安装程序，按提示完成安装
4. 打开命令行，运行以下命令下载模型：

```bash
# 下载中文大模型（推荐）
ollama pull qwen2.5:7b

# 或者下载其他模型
ollama pull llama3.2:3b
ollama pull mistral:7b
```

#### macOS 用户：
```bash
# 使用 Homebrew 安装
brew install ollama

# 下载模型
ollama pull qwen2.5:7b
```

#### Linux 用户：
```bash
# 一键安装脚本
curl -fsSL https://ollama.ai/install.sh | sh

# 下载模型
ollama pull qwen2.5:7b
```

### 2. 启动 Ollama 服务
```bash
# 启动 Ollama 服务
ollama serve

# 在另一个终端测试模型
ollama run qwen2.5:7b
```

### 3. 创建数据库表
运行 `chat_tables.sql` 文件中的 SQL 语句，创建必要的数据库表。

### 4. 配置应用
在 `application.yml` 中确认配置：
```yaml
chatbot:
  ollama-url: http://localhost:11434
  model: qwen2.5:7b
  max-tokens: 2048
  temperature: 0.7
```

### 5. 启动后端服务
```bash
mvn spring-boot:run
```

### 6. 启动前端服务
```bash
cd frontend
npm run dev
```

## 使用方法

### 1. 集成到页面
在需要显示智能客服的页面中引入组件：
```vue
<template>
  <div>
    <!-- 其他页面内容 -->
    <ChatWidget />
  </div>
</template>

<script setup>
import ChatWidget from '@/components/ChatWidget.vue'
</script>
```

### 2. 测试智能客服
1. 点击右下角的"智能客服"按钮
2. 输入问题，如"如何查询订单状态？"
3. 系统会自动回答并给出建议

## 功能特性

### 1. 智能问答
- 基于知识库的精准回答
- 上下文理解
- 多轮对话支持

### 2. 知识库管理
- 支持FAQ导入
- 关键词匹配
- 优先级排序

### 3. 人工转接
- 低置信度自动转人工
- 手动转人工选项
- 会话状态管理

### 4. 快捷问题
- 常见问题模板
- 一键提问
- 问题分类

## 自定义配置

### 1. 修改系统提示词
在 `application.yml` 中修改：
```yaml
chatbot:
  system-prompt: "你是一个专业的零食商城客服助手..."
```

### 2. 调整模型参数
```yaml
chatbot:
  temperature: 0.7    # 创造性（0.0-1.0）
  max-tokens: 2048    # 最大输出长度
```

### 3. 添加知识库
在 `knowledge_base` 表中添加新的问答对：
```sql
INSERT INTO knowledge_base (category, question, answer, keywords, priority) 
VALUES ('新分类', '新问题', '新答案', '关键词1,关键词2', 8);
```

## 故障排除

### 1. Ollama 连接失败
- 检查 Ollama 服务是否启动
- 确认端口 11434 是否被占用
- 检查防火墙设置

### 2. 模型下载失败
- 检查网络连接
- 尝试使用代理
- 选择其他模型

### 3. 回答质量不佳
- 调整 temperature 参数
- 优化系统提示词
- 扩充知识库内容

## 性能优化

### 1. 模型选择
- 7B 模型：平衡性能和效果
- 3B 模型：更快的响应速度
- 13B+ 模型：更好的回答质量

### 2. 缓存策略
- 会话缓存
- 知识库缓存
- 响应缓存

### 3. 并发处理
- 异步消息处理
- 连接池管理
- 负载均衡

## 扩展功能

### 1. 多语言支持
- 中文优先
- 英文支持
- 其他语言扩展

### 2. 情感分析
- 用户情绪识别
- 个性化回复
- 满意度评估

### 3. 业务集成
- 订单查询
- 商品推荐
- 支付帮助

## 注意事项

1. **资源要求**：7B 模型需要至少 8GB 内存
2. **首次启动**：模型加载可能需要几分钟
3. **网络要求**：首次下载模型需要稳定的网络连接
4. **存储空间**：模型文件占用约 4-8GB 磁盘空间

## 技术支持

如遇到问题，请检查：
1. Ollama 服务状态
2. 数据库连接
3. 应用日志
4. 网络连接

## 更新日志

- v1.0.0：基础智能客服功能
- v1.1.0：知识库集成
- v1.2.0：多轮对话支持
- v1.3.0：人工转接功能
