# 零食商城 · 项目答辩PPT大纲（可直接生成PPT）

## 1. 封面
- 题目：零食商城（全栈电商：Spring Boot + Vue3）
- 学生：姓名/学号｜指导老师：姓名｜时间：2025年9月
- 简介：覆盖“商品→购物车→订单→支付→评价→商家/管理员后台”的端到端电商系统

## 2. 项目背景与目标
- 背景：中小商家线上经营需求增长，期望低成本上线、标准链路齐全、易运维。
- 目标：
  - 完成 C 端与 B 端、管理员全角色业务闭环
  - 接入支付宝沙箱，打通真实支付链路（含回调）
  - 形成工程化资产：API、测试集、一键脚本与运维指南

## 3. 用户痛点与需求分析
- 消费者：找商品难、筛选弱、下单流程复杂、支付易卡住、评价入口不清晰。
- 商家：商品/订单管理繁琐、发货与物流追踪缺失、缺乏数据看板。
- 管理员：审核与风控维度少、统计视角弱。
- 对应需求：
  - 高效商品检索（分类/关键词/价格区间/排序/分页）
  - 购物车选中语义与多端一致（服务端为准）
  - 一键发起支付与稳健回调（return/notify）
  - 商家发货、物流轨迹、统计看板；管理员审核与全站统计

## 4. 系统总体设计
- 前后端分离：Vue3 + Element Plus + Pinia + Axios + Vue Router
- 后端：Spring Boot + Spring Security + JPA + MySQL，分层（Controller/Service/Repository/Entity）
- 集成：支付宝沙箱、文件上传（头像/商品图/轮播图）、
- 角色：消费者、商家、管理员（JWT 鉴权与路由守卫）

## 5. 技术栈与关键技术
- 前端：Vite 构建、组件化视图、组合式 API、事件总线、跨窗 postMessage
- 后端：JPA 实体建模、@Transactional 保障原子性、DTO 装配、分页统一封装
- 支付：`/alipay/create-page` 新窗唤起 + `notify` 异步验签 + `return/redirect` 同步兜底
- 存储：本地静态目录（可切换 OSS/CDN），URL 前缀解耦
- 联调：ngrok 穿透与 `ngrok-skip-browser-warning` 头、跨域与缓存头设置

## 6. 核心功能一：商品系统
- 公共列表：分类筛选、关键词搜索、价格区间、排序（price asc/desc、created desc）、分页
- 详情：图文信息、库存
- 类目：树形结构，商家/管理员维护

## 7. 核心功能二：购物车系统
- 加入/更新数量/移除/清空
- 选中语义：全选/单选均调用后端 `toggle`，服务端存储 `checked`，多端一致
- 结算仅取服务端“已选中项”，避免本地态与真实态不一致

## 8. 核心功能三：订单系统
- 下单：从选中购物车项 + 地址生成，校验库存与状态
- 订单流转：UNPAID → PAID → SHIPPED → FINISHED（CANCELLED 分支）
- 详情：订单项、金额、物流进度，支持取消/确认收货

## 9. 核心功能四：支付系统（支付宝沙箱）
- 新窗唤起：避免内嵌空白；支持 `window.open`
- 回调：
  - 同步 `return/redirect`：验签、兜底标记已支付、尝试 `postMessage` 通知父窗并跳转
  - 异步 `notify`：权威验签与状态更新
- 兼容性：切换网关到 `https://openapi.alipaydev.com/gateway.do`；
  添加 `ngrok-skip-browser-warning` 与缓存控制头；Payment 页监听消息 + 轮询兜底

## 10. 核心功能五：评价系统
- 下单后可评价（去重）
- 前端商品详情展示评价摘要



## 12. 重要问题与解决方案（问题→根因→修复→结果）
- 支付页空白：嵌入限制/网关域名差异 → 新窗 + 切换网关 + 头部与轮询 → 顺利唤起
- 回调后未跳转：浏览器阻拦/跨窗失败 → `postMessage` + 父窗强制跳转 + 轮询兜底 → 自动返回订单页
- 购物车选中不同步：仅本地状态 → 后端 `/cart/{id}/toggle` 持久化 → 多端一致
- 分类树重复节点：查询层级不规范 → 递归加载与排序 → 树结构稳定

## 13. 数据与接口设计（模型/接口示例）
- 主要实体：User、Merchant、Category、Product、CartItem、Order、OrderItem、Address、Shipment、LogisticsTrack、Review
- 接口示例：
  - 商品：`GET /products/public/list?categoryId&keyword&sort&page&size`、`GET /products/public/{id}`
  - 购物车：`POST /cart/add`、`PUT /cart/{id}/quantity`、`POST /cart/{id}/toggle`、`DELETE /cart/{id}`
  - 订单：`POST /orders`、`GET /orders/my`、`GET /orders/{id}`、`POST /orders/{id}/cancel`
  - 支付：`GET /alipay/create-page?orderNo=...`、`POST /alipay/notify`、`GET /alipay/redirect`
  - 商家：`/merchant/products` CRUD、`/merchant/orders` 发货与轨迹
  - 管理员：`/admin/users|merchants|orders|statistics`

## 14. 安全与消息控制
- 鉴权：JWT（过期/校验），基于角色的接口/路由控制
- 上传安全：MIME/大小限制、UUID 重命名、目录白名单、URL 前缀隔离
- 订单/支付：签名校验、状态幂等、金额校验、防重复回调

## 15. 性能与可用性优化
- 分页统一 `PageResult`，所有大列表走分页/排序；关键列建立索引（如订单状态+时间）
- 统计聚合下推到仓储层（SQL 聚合），返回前端友好 `labels/values`
- 前端：参数清洗（不传空值）、视图懒加载、列表骨架屏

## 16. 演示脚本（Demo步骤）
1) C 端下单：筛选搜索→加入购物车→全选/单选（触发后端 toggle）→结算→选地址→创建订单
2) 支付：点击支付宝→新窗支付→自动回跳订单页（观察控制台消息与回调日志）
3) 商家后台：订单列表 → 填写快递公司与单号发货 → 追加物流轨迹 → 用户端查看物流
4) 管理员后台：审核商家、启禁用用户、查看全站统计（概览/趋势/分类Top）
5) 文件上传：商品图/轮播图/头像上传与访问 URL 演示



## 18. 项目进度与个人贡献
- 进度：需求 → 设计 → 开发 → 联调 → 测试 → 优化 → 文档与脚本
- 个人负责：
  - 后端：商品/购物车/订单/支付/发货/统计全链路；支付宝回调稳定性；文件上传
  - 前端：商品列表/购物车/结算/支付/订单/后台页面；选中语义与轮询兜底



## 20. 总结与 Q&A
- 结果：端到端电商业务闭环跑通，支付稳定，后台可运营，测试完备
- 价值：可快速复用到中小商家场景，具备扩展性与演进空间
- 亮点：选中语义服务端一致、支付回调稳健化、统计聚合高效、工程化资产齐全

---

### 交给 PPT 生成 AI 的提示
- 结构：严格按 20 章生成，一章一页/多页
- 风格：清爽电商风；模块图标；适量流程图/时序图/架构图
- 强调：购物车服务端选中一致性、支付回调设计、商家发货与轨迹、管理员统计
- Demo 串联路径：筛选→加购→结算→支付→回跳→发货→轨迹→统计
- “问题与修复”页采用四段式：现象 → 根因 → 修复 → 结果


