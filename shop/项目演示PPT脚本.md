## 封面
- **项目名称**：零食商城（全栈电商：Spring Boot + Vue3）
- **作者**：XXX（学号/邮箱）
- **日期**：2025-XX-XX
- 

## 目录（生成PPT时可自动分节）
- 项目背景与目标
- 整体架构与技术栈
- 关键功能与业务流程
- 核心技术亮点与难点突破
- 系统演示脚本（可现场操作）
- 测试与质量保障
- 数据与安全合规
- 性能与扩展性设计
- 项目管理与产出物
- 总结与展望

## 项目背景与目标
- **背景**：实现一个面向商家与消费者的轻量电商系统，覆盖商品、购物车、订单、支付、评价、后台管理全链路。
- **目标**：
  - 学习并落地端到端电商业务闭环
  - 演示可用性（可跑通真实/沙箱支付）
  - 形成工程化资产（API文档、测试、运维脚本）
- **范围**：
  - C 端：商品浏览、筛选/搜索、购物车、下单、支付、评价、个人中心
  - B 端：商家商品管理、订单处理、发货与物流、统计看板
  - 管理员：用户/商家管理、审核、全站统计

## 整体架构与技术栈
- **架构**：前后端分离、分角色权限控制
  - 前端：Vue3 + Vite + Element Plus + Pinia + Axios + Vue Router
  - 后端：Spring Boot + Spring Security + JPA + MySQL
  - 支付：支付宝沙箱（网页收银台），支持同步/异步回调
  - AI/聊天：Ollama（可选）
  - 部署/联调：ngrok/本地穿透，静态资源上传至本地目录
- **配置关键点**：
  - `application.yml`：数据源、JPA、JWT、上传目录、Alipay 网关/密钥/回调地址
  - 前端 `.env`：后端 baseURL，资源前缀

## 关键页面与模块
- 商品系统：分类、搜索、排序、分页、详情
- 购物车系统：增删改查、数量校验、选中语义与服务端同步
- 订单系统：创建/取消/确认收货、订单明细
- 支付系统：支付宝沙箱（新窗口唤起 + return/notify 回调 + 自动跳转）
- 评价系统：下单后可评价，过滤重复评价
- 地址与个人中心：地址 CRUD、默认地址、头像上传
- 商家后台：商品 CRUD、上下架、订单发货与物流轨迹、统计（趋势/Top）
- 管理员后台：用户/商家管理与审核、全站订单分页、统计概览

## 核心业务流程（可做泳道图）
1) 选品下单：浏览→加入购物车→结算→选择地址→生成订单
2) 支付回调：创建支付页→支付宝→同步 return/异步 notify→更新订单状态
3) 商家发货：订单发货→生成 Shipment→添加 LogisticsTrack→用户查看物流
4) 完成闭环：收货/评价→统计入库→后台报表

## 核心技术亮点
- **状态机式接口设计**：上/下架、发货、关闭订单等用“动作 API”，避免随意改字段引发非法状态。
- **DTO 装配策略**：
  - 列表页采用 `Page.map(DTO::from)` 就地装配（如 `AdminOrderListDTO`），避免 N+1 与冗余字段暴露。
  - 详情页使用 DetailDTO，分层清晰、可演进。
- **选中语义一致性**：购物车项 `checked` 与后端同步，保障多端一致。
- **支付稳定性优化**：
  - 网关从 `openapi-sandbox.dl.alipaydev.com` 切换为 `openapi.alipaydev.com`
  - `window.open` 新窗唤起 + `return/redirect` 页内 `postMessage` + 轮询兜底 + `ngrok-skip-browser-warning` 头
- **统计聚合**：Repository 层使用 SQL 聚合，返回前端友好结构（labels/values），避免前端重拼。
- **文件上传安全**：MIME/大小限制、UUID 重命名、目录白名单与 URL 前缀隔离。

## 代码结构与关键文件（示例）
- 后端：
  - `controller/AdminController.java`：管理员分页与统计；`AdminOrderListDTO.fromOrder()` 装配
  - `controller/MerchantController.java`：商家商品/订单/发货/统计
  - `controller/FileUploadController.java`：商品图/头像/通用图上传
  - `controller/AlipayController.java`：`create-page`、`notify`、`return/redirect`
  - `service/*`：事务与业务规则；`@Transactional` 保障原子性
  - `entity/*`：`Product/Order/OrderItem/Shipment/LogisticsTrack` 等实体
- 前端：
  - 购物流程：`views/Products.vue`、`views/Cart.vue`、`views/Checkout.vue`、`views/Payment.vue`
  - 后台：`views/merchant/MerchantProducts.vue`、`views/MerchantDashboard.vue`
  - API：`src/api/*.ts` 分领域封装；`stores/user.ts` 管理登录态

## 系统演示脚本（逐步操作）
1. 登录：管理员/商家/用户（三套账号），展示不同菜单
2. C端下单：
   - 商品筛选/搜索→加入购物车→全选/单选→结算→选择地址→创建订单
   - 支付：选择支付宝→新窗口付款→自动跳转订单页（观察浏览器控制台/回调日志）
3. 商家发货：
   - 后台订单列表→发货（填公司与单号）→追加物流轨迹→用户端查看物流
4. 管理员审核：
   - 用户/商家列表与启禁用、商家审核/暂停/恢复→全站统计/趋势/Top
5. 文件上传：
   - 商品图/轮播图/头像上传→预览 URL 与静态资源目录

## Demo 成功判定
- 订单能从 UNPAID→PAID→SHIPPED→FINISHED 正常流转
- 回调 `notify` 记录成功，`return/redirect` 页面自动跳转
- 物流轨迹可见、统计面板数据变化

## 测试与质量保障
- **接口测试**：Postman/IntelliJ HTTP Client 集合（50+ 用例），覆盖认证、商品、购物车、订单、支付、评价、后台
- **数据准备**：`test_data_preparation.sql`（分类/商品/轮播图/测试账号）
- **一键脚本**：`quick_test.(bat|sh)` 启动/联调
- **前端测试方案**：`前端功能测试方案.md`（120+ 用例）

## 数据与安全合规
- **鉴权**：JWT（过期/刷新策略），基于角色路由守卫
- **输入校验**：DTO + 校验注解，服务层二次校验（库存、状态）
- **最小权限**：商家仅能操作自身数据，管理员全局
- **文件安全**：类型/大小/路径校验，避免目录穿越

## 性能与扩展性
- 分页与排序：统一 `PageResult` 格式，索引命中（如 `order.created_at`、`order.status`）
- 读写分离思路：统计聚合走只读事务；热点列表走缓存（可选）
- 可扩展：
  - 第三方存储（OSS/CDN）替换上传目录 → 仅改配置
  - 支付渠道可插拔（Mock/支付宝/微信）→ 统一支付服务接口
  - 查询维度可扩展（更多筛选/排序）→ 前端参数清洗不变

## 项目管理与产出物
- 文档：`系统测试完整方案.md`、`Postman_测试指南.md`、`支付宝沙箱配置说明.md`
- 代码规范：命名可读、DTO/Service/Repository 分层、注释解释“为什么”
- 产出：
  - 可运行的前后端工程（含 dist 构建产物）
  - 脚本与测试集
  - 演示用账号与测试数据

## 关键难点与解决方案（精选）
- 沙箱支付空白页：
  - 原因：网关域名、浏览器策略、跨窗通信限制
  - 方案：切换网关、`window.open`、`ngrok-skip-browser-warning` 头、同步 return + 异步 notify、轮询兜底
- 购物车选中一致性：
  - 原因：多端状态不同步
  - 方案：勾选触发 `/cart/{id}/toggle`，结算仅取服务端已选中的项



## 展示效果（PPT可插图）
- 前端关键页面截图：商品列表/详情、购物车、结算、支付页、订单详情、商家后台、管理员仪表盘
- 后端关键接口截图：Swagger/HTTP Client、回调日志

## 总结与展望
- 已达成：端到端业务闭环、支付可用、后台可运营、测试完备
- 可改进：
  - 引入消息队列（订单异步事件）
  - 搜索服务（ES）与推荐
  - 多商家结算与对账、优惠券/活动

## 附：现场演示“口播稿”提要（可做备注页）
- 1分钟：背景目标与整体架构
- 3分钟：下单支付链路演示（创建→支付→回调→订单更新）
- 2分钟：商家发货与物流、统计
- 1分钟：管理员审核与概览
- 1分钟：技术亮点与难点
- 1分钟：测试与质量、总结展望


