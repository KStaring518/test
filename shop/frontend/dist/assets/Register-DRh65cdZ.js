import{d as y,r as g,l as k,c as x,a as o,w as s,b as u,m as C,h as f,f as P,E as c,u as R,e as U}from"./index-jh95nJwH.js";import{u as q}from"./user-TGyX2SHZ.js";import{_ as h}from"./_plugin-vue_export-helper-BDJoutlP.js";const E={class:"register-container"},N=y({__name:"Register",setup(S){const b=R(),w=q(),d=g(),m=g(!1),r=k({username:"",password:"",confirmPassword:"",nickname:"",phone:"",email:""}),_={username:[{required:!0,message:"请输入用户名",trigger:"blur"},{min:4,max:20,message:"用户名长度在4到20个字符",trigger:"blur"},{pattern:/^[a-zA-Z0-9_]+$/,message:"用户名只能包含字母、数字和下划线",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"},{min:6,max:20,message:"密码长度在6到20个字符",trigger:"blur"}],confirmPassword:[{required:!0,validator:(a,e,t)=>{e===""?t(new Error("请再次输入密码")):e!==r.password?t(new Error("两次输入密码不一致")):t()},trigger:"blur"}],nickname:[{required:!0,message:"请输入昵称",trigger:"blur"},{max:50,message:"昵称长度不能超过50个字符",trigger:"blur"}],phone:[{required:!0,message:"请输入手机号",trigger:"blur"},{pattern:/^1[3-9]\d{9}$/,message:"请输入正确的手机号",trigger:"blur"}],email:[{required:!0,message:"请输入邮箱",trigger:"blur"},{type:"email",message:"请输入正确的邮箱地址",trigger:"blur"}]},i=async()=>{if(d.value)try{await d.value.validate(),m.value=!0,console.log("注册数据:",r),console.log("注册数据JSON:",JSON.stringify(r));const a=await w.register(r);console.log("注册响应:",a),c.success("注册成功，请登录"),b.push("/login")}catch(a){console.error("注册错误:",a),console.error("错误详情:",a.response),console.error("错误状态:",a.response?.status),console.error("错误数据:",a.response?.data);const e=a.response?.data?.message||a.message||"注册失败";c.error(e)}finally{m.value=!1}};return(a,e)=>{const t=u("el-input"),n=u("el-form-item"),p=u("el-button"),V=u("el-form"),v=u("el-card");return U(),x("div",E,[o(v,{class:"register-card"},{header:s(()=>[...e[7]||(e[7]=[P("h2",null,"用户注册",-1)])]),default:s(()=>[o(V,{ref_key:"registerFormRef",ref:d,model:r,rules:_,"label-width":"80px",onSubmit:C(i,["prevent"])},{default:s(()=>[o(n,{label:"用户名",prop:"username"},{default:s(()=>[o(t,{modelValue:r.username,"onUpdate:modelValue":e[0]||(e[0]=l=>r.username=l),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"密码",prop:"password"},{default:s(()=>[o(t,{modelValue:r.password,"onUpdate:modelValue":e[1]||(e[1]=l=>r.password=l),type:"password",placeholder:"请输入密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"确认密码",prop:"confirmPassword"},{default:s(()=>[o(t,{modelValue:r.confirmPassword,"onUpdate:modelValue":e[2]||(e[2]=l=>r.confirmPassword=l),type:"password",placeholder:"请再次输入密码","show-password":"",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"昵称",prop:"nickname"},{default:s(()=>[o(t,{modelValue:r.nickname,"onUpdate:modelValue":e[3]||(e[3]=l=>r.nickname=l),placeholder:"请输入昵称",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"手机号",prop:"phone"},{default:s(()=>[o(t,{modelValue:r.phone,"onUpdate:modelValue":e[4]||(e[4]=l=>r.phone=l),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),o(n,{label:"邮箱",prop:"email"},{default:s(()=>[o(t,{modelValue:r.email,"onUpdate:modelValue":e[5]||(e[5]=l=>r.email=l),placeholder:"请输入邮箱",clearable:""},null,8,["modelValue"])]),_:1}),o(n,null,{default:s(()=>[o(p,{type:"primary",onClick:i,loading:m.value},{default:s(()=>[...e[8]||(e[8]=[f(" 注册 ",-1)])]),_:1},8,["loading"]),o(p,{onClick:e[6]||(e[6]=l=>a.$router.push("/login"))},{default:s(()=>[...e[9]||(e[9]=[f(" 返回登录 ",-1)])]),_:1})]),_:1})]),_:1},8,["model"])]),_:1})])}}}),J=h(N,[["__scopeId","data-v-56bbb341"]]);export{J as default};
